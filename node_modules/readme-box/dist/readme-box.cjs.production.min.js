"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@octokit/request");exports.ReadmeBox=function(){function t(t){this.owner=t.owner,this.repo=t.repo,this.token=t.token,this.branch=t.branch||"master",this.request=e.request.defaults({headers:{authorization:"token "+this.token}})}t.updateSection=function(e,n){try{var r=new t(n);return Promise.resolve(r.getReadme()).then((function(t){var o=t.sha,s=t.path,a=r.replaceSection({section:n.section,oldContents:t.content,newContents:e});return r.updateReadme({content:a,message:n.message,sha:o,path:s})}))}catch(e){return Promise.reject(e)}};var n=t.prototype;return n.getReadme=function(){try{return Promise.resolve(this.request("GET /repos/:owner/:repo/readme",{owner:this.owner,repo:this.repo})).then((function(e){var t=e.data;return{content:Buffer.from(t.content,"base64").toString("utf8"),sha:t.sha,path:t.path}}))}catch(e){return Promise.reject(e)}},n.updateReadme=function(e){try{return Promise.resolve(this.request("PUT /repos/:owner/:repo/contents/:path",{owner:this.owner,repo:this.repo,content:Buffer.from(e.content).toString("base64"),path:e.path||"README.md",message:e.message||"Updating the README!",sha:e.sha,branch:"master"}))}catch(e){return Promise.reject(e)}},n.getSection=function(e,t){var n,r=this.createRegExp(e),o=t.match(r.regex);return null==o||null===(n=o.groups)||void 0===n?void 0:n.content},n.replaceSection=function(e){var t=this.createRegExp(e.section),n=t.regex,r=t.start,o=t.end;if(!n.test(e.oldContents))throw new Error('Contents do not contain start/end comments for section "'+e.section+'"');return e.oldContents.replace(n,r+"\n"+e.newContents+"\n"+o)},n.createRegExp=function(e){var t="\x3c!--START_SECTION:"+e+"--\x3e",n="\x3c!--END_SECTION:"+e+"--\x3e";return{regex:new RegExp(t+"\n(?:(?<content>[\\s\\S]+)\n)?"+n),start:t,end:n}},t}();
//# sourceMappingURL=readme-box.cjs.production.min.js.map
